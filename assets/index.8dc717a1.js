import{d as t,h as e,r as s,c as r,a as n,b as i,o as a,w as o,t as c,F as h,e as l,f as d}from"./vendor.a9ea7574.js";const u="undefined"!=typeof navigator&&/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);var f=t({props:{distanceToRefresh:{type:Number,default:42},damping:{type:Number,default:224},scale:{type:Number,default:.6},onRefresh:{type:Function,default:null}},data:()=>({state:{currSt:"deactivate",dragOnEdge:!1},isScrolling:!1,progress:0,_startScreenX:null,_startScreenY:null,_ScreenY:null,_lastScreenY:null,scrollTop:0}),mounted(){const t=this.$el;t.addEventListener("touchstart",this.onStart),t.addEventListener("touchmove",this.onMove),t.addEventListener("touchend",this.onEnd),t.addEventListener("touchcancel",this.onEnd)},beforeUnmount(){const t=this.$el;t.removeEventListener("touchstart",this.onStart),t.removeEventListener("touchmove",this.onMove),t.removeEventListener("touchend",this.onEnd),t.removeEventListener("touchcancel",this.onEnd)},methods:{onStart(t){this._startScreenX=t.touches[0].screenX,this._startScreenY=t.touches[0].screenY,this._ScreenY=t.touches[0].screenY,this._lastScreenY=this._lastScreenY||0},onMove(t){const e=this.$el,s=t.touches[0].screenY,r=t.touches[0].screenX;if(!(Math.abs(r-this._startScreenX)>20*window.devicePixelRatio)&&!(this._startScreenY>s)&&this.isEdge(e)){this.state.dragOnEdge||(this._startScreenY=t.touches[0].screenY,this._ScreenY=t.touches[0].screenY,this.state.dragOnEdge=!0),t.preventDefault();const e=Math.round(s-this._ScreenY);this._ScreenY=s,this._lastScreenY+=this.gravity(e);const r=this._lastScreenY/this.damping;this.progress=r>1?1:r,this.setContentStyle(this._lastScreenY),Math.abs(this._lastScreenY)<this.distanceToRefresh?"deactivate"!==this.state.currSt&&(this.state.currSt="deactivate"):"deactivate"===this.state.currSt&&(this.state.currSt="activate"),u&&t.changedTouches[0].clientY<0&&this.onEnd(t)}},async onEnd(t){this.state.dragOnEdge&&(this.state.dragOnEdge=!1),"activate"===this.state.currSt?(this.state.currSt="loading",this.triggerPullToRefresh(),this.onRefresh&&await this.onRefresh(),this.state.currSt="finish",this.state.dragOnEdge||this.reset()):this.reset()},isEdge:t=>t.scrollTop<=0,gravity(t){return t*=(1-Math.abs(this._ScreenY-this._startScreenY)/window.screen.height)*this.scale},triggerPullToRefresh(){this.state.dragOnEdge||(this._lastScreenY=this.distanceToRefresh+1,this.state.currSt="loading",this.setContentStyle(this._lastScreenY))},reset(){this._lastScreenY=0,this.setContentStyle(0)},setContentStyle(t){const e=this.$refs.contents.style;e.transform=`translate3d(0px,${t}px,0)`,e.webkitTransform=`translate3d(0px,${t}px,0)`,e.MozTransform=`translate3d(0px,${t}px,0)`},scrollTo(t=0,e=!0){if(!this.$refs.scrollView||this.isScrolling)return;const s=this.$refs.scrollView;if(!e)return void(s.scrollTop=t);this.isScrolling=!0;const r=t;let n=s.scrollTop;const i=Math.abs(r-n)>1e3?1e3:500,a=Date.now();let o=!1;const c=()=>{if(o||Math.abs(r-n)<50)return s.scrollTop=r,void(this.isScrolling=!1);window.requestAnimationFrame(c);const t=Date.now();t-a>=i&&(o=!0);const e=(t-a)/i,h=this.easeInOut(e);n+=(r-n)*h,s.scrollTop=n};window.requestAnimationFrame(c)},easeInOut:t=>(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},render(){return e("div",{ref:"scrollView",style:this.isScrolling?{overflow:"hidden"}:{}},[e("div",{style:{overflow:"hidden"}},[e("div",{ref:"contents",style:this.state.dragOnEdge?{width:"100%","transform-origin":"left top 0px"}:{width:"100%","transform-origin":"left top 0px",transition:"transform 0.3s","-webkit-transition":"transform 0.3s"}},[e("div",{ref:"loading",style:{height:`${this.distanceToRefresh}px`,"margin-top":`-${this.distanceToRefresh}px`}},s(this.$slots,"loading",{state:this.state.currSt,progress:this.progress},(()=>[]))),s(this.$slots,"default",{},(()=>[]))])])])}});function g(t){t.component("RefreshableScrollView",f)}"undefined"!=typeof window&&window.Vue&&g(window.Vue);const S={install:g};var p=t({data:()=>({items:[...Array(51).keys()]}),methods:{async onRefersh(){await new Promise((t=>setTimeout(t,2e3)))}}});const v={class:"flex flex-col h-screen"},m=n("h2",{class:"m-4 text-4xl font-bold"},"Refreshable ScrollView",-1),w=n("h4",{class:"mx-4 mb-2 text-lg text-gray-400"}," iOS Style Vue component that you can pull to refresh. ",-1),y={class:"grid w-full h-full text-gray-500 place-items-center"},Y={class:"px-2"};p.render=function(t,e,s,d,u,f){const g=i("RefreshableScrollView");return a(),r("div",v,[m,w,n(g,{class:"flex-grow overflow-y-auto","on-refresh":t.onRefersh},{loading:o((({state:t,progress:e})=>[n("div",y,c(t),1)])),default:o((()=>[n("div",Y,[(a(!0),r(h,null,l(t.items,((t,e)=>(a(),r("div",{key:e,class:"py-2"},c(t),1)))),128))])])),_:1},8,["on-refresh"])])};const _=d(p);_.use(S),_.mount("#app");
